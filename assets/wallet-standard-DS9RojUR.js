import{P as X,a as G,V as y,R as tt,T as x,b as Y,S as et}from"./index-Cu4qe3a2.js";var at=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},nt=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},S;function Z(s){const e=({register:t})=>t(s);try{window.dispatchEvent(new st(e))}catch(t){console.error(`wallet-standard:register-wallet event could not be dispatched
`,t)}try{window.addEventListener("wallet-standard:app-ready",({detail:t})=>e(t))}catch(t){console.error(`wallet-standard:app-ready event listener could not be added
`,t)}}class st extends Event{get detail(){return at(this,S,"f")}get type(){return"wallet-standard:register-wallet"}constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),S.set(this,void 0),nt(this,S,e,"f")}preventDefault(){throw new Error("preventDefault cannot be called")}stopImmediatePropagation(){throw new Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw new Error("stopPropagation cannot be called")}}S=new WeakMap;const it={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},j={mainnet:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedMainnet:"4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",devnet:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedDevnet:"8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};function rt(s){return it[s]||[]}function ot(s){return{methods:rt(s),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}}function lt(s){return s.reduce((e,t)=>{const{id:a,chainNamespace:i,rpcUrls:r}=t,o=r.default.http[0];e[i]||(e[i]=ot(i));const h=`${i}:${a}`,c=e[i];switch(c==null||c.chains.push(h),h){case j.mainnet:c.chains.push(j.deprecatedMainnet);break;case j.devnet:c.chains.push(j.deprecatedDevnet);break}return c!=null&&c.rpcMap&&o&&(c.rpcMap[a]=o),e},{})}const B=["solana:mainnet","solana:devnet","solana:testnet","solana:localnet"];var D=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},T=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},E,m,z,W,C,L;class ct{get address(){return D(this,E,"f")}get publicKey(){return D(this,m,"f").slice()}get chains(){return D(this,z,"f").slice()}get features(){return D(this,W,"f").slice()}get label(){return D(this,C,"f")}get icon(){return D(this,L,"f")}constructor({address:e,publicKey:t,label:a,icon:i}){E.set(this,void 0),m.set(this,void 0),z.set(this,void 0),W.set(this,void 0),C.set(this,void 0),L.set(this,void 0),T(this,E,e,"f"),T(this,m,t,"f"),T(this,z,B,"f"),T(this,W,["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"],"f"),T(this,C,a,"f"),T(this,L,i,"f")}}E=new WeakMap,m=new WeakMap,z=new WeakMap,W=new WeakMap,C=new WeakMap,L=new WeakMap;function Q(s){return B.includes(s)}function _(s){return"version"in s}var n=function(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)},N=function(s,e,t,a,i){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!i:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?i.call(s,t):i?i.value=t:e.set(s,t),t},A,f,P,M,v,k,d,F,q,V,p,I,b,K,R,U,H,O;function dt(s){return{"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"solana:mainnet","solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ":"solana:mainnet","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"solana:testnet","solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K":"solana:devnet","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":"solana:devnet"}[s]}class J{static register(e){const t=new J(e);Z(t)}get version(){return n(this,P,"f")}get name(){return n(this,v,"f")}get icon(){return n(this,k,"f")}get chains(){return B.slice()}get features(){return{"standard:connect":{version:"1.0.0",connect:n(this,K,"f")},"standard:disconnect":{version:"1.0.0",disconnect:n(this,R,"f")},"standard:events":{version:"1.0.0",on:n(this,F,"f")},"solana:signAndSendTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:n(this,U,"f")},"solana:signTransaction":{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:n(this,H,"f")},"solana:signMessage":{version:"1.0.0",signMessage:n(this,O,"f")}}}get accounts(){var a,i,r;const e=(i=(a=n(this,M,"f").session)==null?void 0:a.namespaces)==null?void 0:i.solana,t=(r=e==null?void 0:e.chains)==null?void 0:r.map(o=>dt(o));return(e==null?void 0:e.accounts.map(o=>{const{address:h}=X.parseCaipAddress(o),c=new G(y.decode(h));return{address:h,publicKey:c.toBytes(),chains:t,features:["solana:signAndSendTransaction","solana:signTransaction","solana:signMessage"]}}))||[]}constructor(e){A.add(this),f.set(this,{}),P.set(this,"1.0.0"),M.set(this,void 0),v.set(this,"WalletConnect"),k.set(this,"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+"),d.set(this,null),F.set(this,(t,a)=>(n(this,f,"f")[t]||(n(this,f,"f")[t]=[]),n(this,f,"f")[t].push(a),()=>n(this,A,"m",V).call(this,t,a))),p.set(this,()=>{const t=this.accounts[0];(t==null?void 0:t.publicKey)&&(N(this,d,new ct(t),"f"),n(this,A,"m",q).call(this,"change",{accounts:this.accounts}))}),I.set(this,()=>{n(this,d,"f")&&(N(this,d,null,"f"),n(this,A,"m",q).call(this,"change",{accounts:this.accounts}))}),b.set(this,()=>{var t,a,i;(i=(a=(t=n(this,M,"f").session)==null?void 0:t.namespaces)==null?void 0:a.solana)!=null&&i.accounts.length?n(this,p,"f").call(this):n(this,I,"f").call(this)}),K.set(this,async()=>(n(this,d,"f")||(tt.push("ConnectingWalletConnect"),await n(this,M,"f").connect({namespaces:lt([et.DEFAULT_CHAIN])})),n(this,p,"f").call(this),{accounts:this.accounts})),R.set(this,async()=>{await n(this,M,"f").disconnect()}),U.set(this,async(...t)=>{var i;if(!n(this,d,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:r,account:o,chain:h,options:c}=t[0]||{},{minContextSlot:l,preflightCommitment:u,skipPreflight:g,maxRetries:w}=c||{};if((o==null?void 0:o.address)!==((i=n(this,d,"f"))==null?void 0:i.address))throw new Error("invalid account");if(!Q(h||":"))throw new Error("invalid chain");if(!r)throw new Error("invalid transaction");const $=await n(this,M,"f").request({method:"solana_signAndSendTransaction",params:{transaction:r,pubkey:n(this,d,"f").address,sendOptions:{preflightCommitment:u,minContextSlot:l,maxRetries:w,skipPreflight:g}}});a.push({signature:y.decode($.signature)})}else if(t.length>1){const r=await Promise.all(t.map(o=>n(this,U,"f").call(this,o)));for(const o of r)a.push(...o)}return a}),H.set(this,async(...t)=>{var i;if(!n(this,d,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{transaction:r,account:o,chain:h}=t[0]||{};if((o==null?void 0:o.address)!==n(this,d,"f").address)throw new Error("invalid account");if(h&&!Q(h))throw new Error("invalid chain");if(!r)throw new Error("invalid transaction");const c=x.from(r);let l;const u=await n(this,M,"f").request({method:"solana_signTransaction",params:{transaction:r,pubkey:n(this,d,"f").address}});if("signature"in u){const w=y.decode(u.signature);c.addSignature(new G(n(this,d,"f").publicKey),Buffer.from(w)),l=c}else{const w=Buffer.from(u.transaction,"base64");_(c)&&(l=Y.deserialize(new Uint8Array(w))),l=x.from(w)}if(!l)throw new Error("invalid transaction");const g=_(l)?l.serialize():new Uint8Array(l.serialize({requireAllSignatures:!1,verifySignatures:!1}));a.push({signedTransaction:g})}else if(t.length>1){let r;for(const l of t){if(((i=l.account)==null?void 0:i.address)!==n(this,d,"f").address)throw new Error("invalid account");if(l.chain){if(!Q(l.chain))throw new Error("invalid chain");if(r&&l.chain!==r)throw new Error("conflicting chain");r=l.chain}}const o=t.map(({transaction:l})=>Y.deserialize(l)),c=(await n(this,M,"f").request({method:"solana_signAllTransactions",params:{transactions:o}})).transactions.map((l,u)=>{const g=o[u];if(!g)throw new Error("Invalid transactions response");const w=Buffer.from(l,"base64");return _(g)?Y.deserialize(new Uint8Array(w)):x.from(w)});a.push(...c.map(l=>({signedTransaction:_(l)?l.serialize():new Uint8Array(l.serialize({requireAllSignatures:!1,verifySignatures:!1}))})))}return a}),O.set(this,async(...t)=>{if(!n(this,d,"f"))throw new Error("not connected");const a=[];if(t.length===1){const{message:i,account:r}=t[0]||{};if((r==null?void 0:r.address)!==n(this,d,"f").address)throw new Error("invalid account");if(!i)throw new Error("invalid message");const o=await n(this,M,"f").request({method:"solana_signMessage",params:{message:i,pubkey:n(this,d,"f").address}});a.push({signedMessage:i,signature:y.decode(o.signature)})}else if(t.length>1){const i=await Promise.all(t.map(r=>n(this,O,"f").call(this,r)));for(const r of i)a.push(...r)}return a}),N(this,M,e,"f"),this.setProvider(e),Z(this)}setProvider(e){N(this,M,e,"f"),N(this,v,"WalletConnect","f"),e.on("connect",()=>n(this,p,"f").call(this)),e.on("disconnect",()=>n(this,I,"f").call(this)),e.on("accountsChanged",()=>n(this,b,"f").call(this)),e.on("chainChanged",()=>n(this,b,"f").call(this)),n(this,p,"f").call(this)}}f=new WeakMap,P=new WeakMap,M=new WeakMap,v=new WeakMap,k=new WeakMap,d=new WeakMap,F=new WeakMap,p=new WeakMap,I=new WeakMap,b=new WeakMap,K=new WeakMap,R=new WeakMap,U=new WeakMap,H=new WeakMap,O=new WeakMap,A=new WeakSet,q=function(e,...t){var a;(a=n(this,f,"f")[e])==null||a.forEach(i=>i.apply(null,t))},V=function(e,t){var a;n(this,f,"f")[e]=(a=n(this,f,"f")[e])==null?void 0:a.filter(i=>t!==i)};export{J as SolanaWalletConnectStandardWallet};
